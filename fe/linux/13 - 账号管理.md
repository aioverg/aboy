#### 账号管理

##### 基本内容

1. `/etc/passwd` ：存放账号，及`UID` （使用者 ID）。

2. `/etc/group` ：存放账号的 `GID` （组群 ID） 。

3. `/etc/shadow` ：存放账号的密码等信息 。

   登录账号时会在 `/etc/passwd` 中查找账号及 `UID` ，在 `/etc/group` 查找 `GID` ，若信息正确在 `/etc/shadow` 查找对应的密码，无误后登录账号。

4. `/etc/group` ：存放组群信息。

##### `/etc/passwd` 文件结构 

文件的每行代表一个账户，各字段使用 `:` 分隔，如图：

<img src="..\img\043.png" style="zoom: 67%;" />

其中 密码 的标识全部为 `x` ，`UID` 中 `0` 代表管理员， `1-999` 代表系统账号，`1000-60000` 表示可登录账号。

##### `/etc/shadow` 文件结构

文件的每行代表一个账户，各字段使用 `:` 分隔，如图：

<img src="..\img\044.png" style="zoom: 67%;" />

##### `etc/group` 文件结构

文件的每行代表一个组群，各字段使用 `:` 分隔，如图：

<img src="..\img\045.png" style="zoom: 67%;" />

##### ACL

ACL是一种更细化的权限管理机制。

##### 命令

- **`groups`** ：输出当前用户的所属组群。

- **`useradd [-u UID] [-g 初始组群] [-G 次要组群] [-mM] [-c 说明] [-d 家目录绝对路径] [-s shel] 使用者账号名`** ：增加账户。

  参数：

  1.  `-u` ：指定一组数字作为 `UID` 。
  2.  `-g` ：指定初始组群。
  3. `-G` ：指定次要组群。
  4. `-m` ：建立用户家目录。
  5. `-M` ：不建立用户家目录。
  6. `-c` ：用户说明信息。
  7. `-d` ：指定家目录的路径。
  8. `-r` ：建立一个系统账号。
  9. `-s` ：指定 `shell`。
  10. `-e` ：指定账号的失效日期，日期格式 `YYYY-MM-DD` 。
  11. `-f` ：指定密码是否会失效， `0` 为立即失效， `-1` 为永远不失效。

- **`passwd 参数 账户名称`** ：操作账户密码，账户名称用于指定操作的账户，不填则默认操作当前账户。

  参数：

  1. `--stdin` ：透过来自前一个管线的数据，作为密码输入。
  2. `-l` ：在 `/etc/shadow` 第二栏最前面加上 `!` 使密码失效。
  3. `-u` ：与 `-l` 相反。
  4. `-S` ：列出密码相关的参数，及 ``/etc/shadow` 文件内的大部分信息。
  5. `-n` ：设置密码不可变动时间。
  6. `-x` ：设置密码需要变更的时间。
  7. `-w` ：设置密码过期的警告时间。
  8. `-i` ：设置密码失效时间。

- **`change 参数 账号名称`** ：显示密码参数。

  参数：

  1. `-l` ：列出账号的详细密码参数。
  2. `-d` ：设置最近改动密码的日期。
  3. `-E` ：设置账号的失效日期，日期格式 `YYYY-MM-DD` 。
  4. `-l` ：设置密码的失效日期。
  5. `-m` ：设置密码不可变更的时间。
  6. `-M` ：设置密码需要变更的时间。
  7. `-W` ：设置密码过期警告的时间。

- **`userdel 参数 账户名称`** ：删除账户。

  参数：

  1. `-r` ：连同用户的家目录一起删除。

- **`id 账户名称`** ：列出当前账户或指定账户的 `UID` `GID` 信息。

- **`groupadd 参数 组名`** ：新增组群。

  参数：

  1. `-g GID` ：指定组群的 `GID` 。
  2. `-r` ：建立系统组群。

- **`groupmod 参数 组名`**：修改组群的相关参数。

  参数：

  1. `-g` ：修改 `GID` 。
  2. `-n` ：修改组名。

- **`groupdel 组名`** ：删除组群。

- **`gpasswd 参数 组名`** ：建立组群管理员。

  参数：

  1. ` ` ：没有参数时，给组群设置一个密码。
  2. `-A 组员列表` ：将控制权交给指定组员。
  3. `-M 账号列表`  ：将账号加入组群中。
  4. `-r` ：移除组群的密码。
  5. `-R` ：让组群的密码栏失效。

- **`gpasswd 参数 组员 组名`** ：将用户加入组群或将组员移除组群。

  参数：

  1. `-a` ：将 `账户` 加入组群。
  2. `-d` ：将 `组员` 移除组群。

- **`su 参数 账户`** ：切换账户。

  参数：

  1. `-m` ：切换用户，但不读取使用者的配置文件。
  2. `-c` ：使用用户进行一次指令。